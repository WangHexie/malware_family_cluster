import datetime

from keras_preprocessing.sequence import pad_sequences

from model import load_model
import numpy as np

now = datetime.datetime.now()
time_name = str(now.month) + "_" + str(now.day) + "_" + str(now.hour) + "_" + str(
    now.minute) + "_" + "features_plus_nn_mid"
model = load_model("./models/weights.01-0.03171408.hdf5", load_type=2)
shape = (512, 64)
input_dim = 92 + 1
batch_size = 16
epochs = 50
class_num = 2

final_api_list = np.load("api_list_stage2.npy")
# final_api_list = np.load("api_list_nn.npy")
# label = np.load("api_list_nn.npy")

fixed_sequence = pad_sequences(final_api_list, maxlen=shape[0], dtype='int32', padding='post', truncating='post',
                               value=input_dim-1)

features = model.predict(fixed_sequence)

np.save("nn_features", features)



